# План улучшения Backend для Образовательного Портала

## 1. Обновление сущностей (Entities)

### 1.1. Обновление Lesson Entity
- [x] Добавлены новые поля в сущность Lesson:
  - `estimatedTime` - ориентировочное время прохождения урока
  - `difficulty` - сложность урока (1-5)
  - `learningObjectives` - цели обучения
  - `prerequisites` - требования для прохождения
  - `videoUrl` - ссылка на видеоурок
  - `attachments` - список вложений
  - `order` - порядковый номер урока в теме

### 1.2. Создание новых сущностей
- [x] Создание сущности `LessonDescriptionDto` для детального описания урока
- [x] Создание сущности `PrerequisitesDto` для списка предшествующих уроков
- [x] Создание сущности `LearningPathDto` для структуры пути обучения
- [x] Создание сущности `RecommendationsDto` для рекомендаций
- [x] Создание сущности `AnalyticsDto` для различных метрик аналитики
- [x] Создание сущности `NotificationDto` для уведомлений

## 2. Создание новых DTO

### 2.1. DTO для описания уроков
- [x] `LessonDescriptionDto` - для детального описания урока
- [x] `PrerequisitesDto` - для списка предшествующих уроков
- [x] `LearningPathDto` - для структуры пути обучения

### 2.2. DTO для системы рекомендаций
- [x] `RecommendationsDto` - для рекомендаций следующих уроков

### 2.3. DTO для аналитики обучения
- [x] `AnalyticsDto` - для различных метрик аналитики
- [x] `UserProgressAnalyticsDto` - для аналитики прогресса пользователя
- [x] `CourseAnalyticsDto` - для аналитики курса

### 2.4. DTO для системы уведомлений
- [x] `NotificationDto` - для уведомлений

## 3. Новые API endpoints

### 3.1. Для описания уроков
- [x] `GET /lessons/:id/description` - детальное описание урока с целями обучения и требованиями
- [x] `GET /lessons/:id/prerequisites` - список уроков, которые нужно пройти перед текущим
- [x] `GET /subjects/:id/learning-path` - полный путь обучения по курсу с зависимостями

### 3.2. Для системы рекомендаций
- [x] `POST /users/:id/recommendations` - рекомендации следующих уроков на основе прогресса
- [x] `GET /users/:id/learning-analytics` - статистика обучения: время, прогресс, сильные/слабые стороны

### 3.3. Для аналитики обучения
- [x] `GET /analytics/user/:id/progress` - прогресс пользователя
- [x] `GET /analytics/user/:id/time-spent` - время, потраченное на обучение
- [x] `GET /analytics/user/:id/success-rate` - успешность прохождения тестов
- [x] `GET /analytics/course/:id/popular-lessons` - популярные уроки в курсе

### 3.4. Для системы уведомлений
- [x] `POST /notifications/lesson-completed` - уведомление о завершении урока
- [x] `POST /notifications/quiz-result` - уведомление с результатами теста
- [x] `POST /notifications/recommendation` - уведомление с рекомендациями

## 4. Архитектурные улучшения

### 4.1. Новые сервисы
- [x] `RecommendationsService` - логика рекомендаций на основе прогресса
- [x] `AnalyticsService` - расчет и предоставление статистики обучения
- [x] `NotificationsService` - отправка уведомлений пользователям
- [x] `LearningPathService` - построение путей обучения

### 4.2. Модификация существующих сервисов
- [x] `LessonsService` - добавить методы для работы с новыми полями
- [x] `ProgressService` - расширить функционал для аналитики
- [x] `SubjectsService` - добавить методы для работы с путями обучения

## 5. Бизнес-логика

### 5.1. Система рекомендаций
- [x] Анализ прогресса пользователя
- [x] Учет сложности уроков
- [x] Рекомендация следующих уроков на основе успешности
- [x] Логика ветвления обучения

### 5.2. Аналитика обучения
- [x] Расчет общего прогресса
- [x] Анализ времени, потраченного на уроки
- [x] Статистика успешности тестов
- [x] Выявление сильных и слабых сторон

### 5.3. Уведомления
- [x] Событийно-ориентированная архитектура
- [x] Различные типы уведомлений
- [ ] Настройка частоты отправки

## 6. Безопасность и производительность

### 6.1. Безопасность
- [x] Валидация всех новых DTO
- [x] Проверка прав доступа к аналитике
- [x] Защита от спама уведомлениями

### 6.2. Производительность
- [x] Кэширование результатов рекомендаций
- [x] Оптимизация запросов для аналитики
- [x] Асинхронная отправка уведомлений

## 7. Тестирование

### 7.1. Unit тесты
- [ ] Тесты бизнес-логики рекомендаций
- [x] Тесты расчета аналитики
- [ ] Тесты валидации DTO

### 7.2. Integration тесты
- [ ] Тесты новых API endpoints
- [ ] Тесты взаимодействия сервисов
- [ ] Тесты работы с базой данных

## 8. Документация

### 8.1. Обновление документации
- [x] Документация новых API endpoints
- [ ] Обновление схемы базы данных
- [ ] Руководство по использованию новых функций
